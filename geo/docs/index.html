<!DOCTYPE html>
<html>
<head>
  <title>AlphaGeometry Input</title>
</head>
<body>
  <h2>Submit Geometry Problem</h2>
  <form id="problem-form">
    <textarea id="problem-input" rows="10" cols="60" placeholder="Enter formal geometry input..."></textarea><br>
    <button type="submit">Submit</button>
  </form>
  <p id="status"></p>

  <script>
    const repo = "yourusername/alpha-geometry-site";
    const token = "ghp_your_github_token_here"; // WARNING: only for testing! Never expose in public!
    
    document.getElementById("problem-form").onsubmit = async (e) => {
      e.preventDefault();
      const content = document.getElementById("problem-input").value;

      const sha = await getCurrentSha();
      const body = {
        message: "User submitted new geometry problem",
        content: btoa(unescape(encodeURIComponent(content))),
        ...(sha && { sha })
      };

      const response = await fetch(`https://api.github.com/repos/${repo}/contents/problem.txt`, {
        method: "PUT",
        headers: {
          Authorization: `token ${token}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify(body)
      });

      if (response.ok) {
        document.getElementById("status").innerText = "Problem submitted successfully!";
      } else {
        document.getElementById("status").innerText = "Error submitting problem.";
      }
    };

    async function getCurrentSha() {
      const response = await fetch(`https://api.github.com/repos/${repo}/contents/problem.txt`, {
        headers: { Authorization: `token ${token}` }
      });
      if (!response.ok) return null;
      const data = await response.json();
      return data.sha;
    }
  </script>
</body>
</html>
